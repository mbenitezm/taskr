#!/usr/bin/env python 

import argparse
from modules import taskr as t

if __name__ == "__main__":

  parser = argparse.ArgumentParser(description='Taskr helps you keep track of time!')
  parser.add_argument("-n", metavar="'write some code'", help='Task name')
  parser.add_argument("-e", metavar="estimated hours", type=float, help='Estimated time in hours')
  parser.add_argument("-i", metavar="", nargs="?", const=True, help='Pause current task')
  parser.add_argument("-p", metavar="", nargs="?", const=True, dest="i", help='Pause current task')
  parser.add_argument("-r", metavar="", nargs="?", const=True, help='Resume current task')
  parser.add_argument("-o", metavar="", nargs="+", help='Open closed task')
  parser.add_argument("-c", metavar="", nargs="?", const=True, help='Close current task')
  parser.add_argument("-cr", metavar="", nargs="?", const=True, help='Close current task and resume previous paused one')
  parser.add_argument("-d", metavar="", nargs="?", const=True, help='Close current task')
  parser.add_argument("-s", metavar="", nargs="?", const=True, help='Show taskr status')
  parser.add_argument("--all", metavar="", nargs="?", const=True, help='Show all taskr status')
  parser.add_argument("--info", metavar="", nargs="?", const=True, help='Show all taskr status')
  args = parser.parse_args()

  taskr = t.Taskr()
  if args.i is not None:
    try:
      taskr.pauseCurrentTask()
    except NoTaskException as nte:
      print colored("No active task","red")
      taskr.printTasks()
  elif args.info is not None:
    taskr.taskInfo(args.info)
  elif args.d is not None:
    taskr.deleteTask(args.d)
    taskr.printTasks()
  elif args.c is not None:
    try:
      taskr.closeCurrentTask()
    except NoTaskException as nte:
      print colored("No active task","red")
      taskr.printTasks()
  elif args.o is not None:
    taskr.openTask(args.o[0])
  elif args.r is not None:
    taskr.resumeCurrentTask(args.r)
  elif args.cr is not None:
    try:
      taskr.closeCurrentTask()
    except NoTaskException as nte:
      print colored("No active task","red")
      taskr.printTasks()
    taskr.resumeCurrentTask(args.cr)
  elif args.s is not None:
    taskr.printTasks()
  elif args.all is not None:
    taskr.printTasks(True)
  elif args.n is not None:
    taskr.newTask(args.n,args.e)
  else:
    taskr.printTasks()

  taskr.saveTasks()
